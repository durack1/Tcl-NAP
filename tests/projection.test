# projection.test --
# 
# Test procedure "projection" defined in file $env(LIBRARY_DIR)/projection.tcl
#
# Copyright (c) 1999, CSIRO Australia
# Author: Harvey Davies, CSIRO Atmospheric Research
# $Id: projection.test,v 1.3 2002/11/29 00:53:30 dav480 Exp $

source $env(LIBRARY_DIR)/projection.tcl

proc p {lats lons} {
    nap "mat = reshape(0, {0 4})"
    foreach lat $lats {
	foreach lon $lons {
	    nap "x = nint(1e9 * projection_x(lat,lon)) / 1e9"
	    nap "y = nint(1e9 * projection_y(lat,lon)) / 1e9"
	    nap "mat = mat // (lat // lon // x // y)"
	}
    }
    return [$mat value]
}

set lats [[nap "ap(-90.0, 90.0, 90.0)"]]
set lons [[nap "ap(-180.0, 360.0, 90.0)"] v]

Test projection-1.1 {CylindricalEquidistant. No origin.} {
    projection CylindricalEquidistant
    p $lats $lons
} { -90 -180 -180  -90
 -90  -90  -90  -90
 -90    0    0  -90
 -90   90   90  -90
 -90  180  180  -90
 -90  270  270  -90
 -90  360  360  -90
   0 -180 -180    0
   0  -90  -90    0
   0    0    0    0
   0   90   90    0
   0  180  180    0
   0  270  270    0
   0  360  360    0
  90 -180 -180   90
  90  -90  -90   90
  90    0    0   90
  90   90   90   90
  90  180  180   90
  90  270  270   90
  90  360  360   90}

Test projection-1.2 {CylindricalEquidistant. Origin = 0.} {
    projection CylindricalEquidistant 0
    p $lats $lons
} { -90 -180  180  -90
 -90  -90  270  -90
 -90    0    0  -90
 -90   90   90  -90
 -90  180  180  -90
 -90  270  270  -90
 -90  360    0  -90
   0 -180  180    0
   0  -90  270    0
   0    0    0    0
   0   90   90    0
   0  180  180    0
   0  270  270    0
   0  360    0    0
  90 -180  180   90
  90  -90  270   90
  90    0    0   90
  90   90   90   90
  90  180  180   90
  90  270  270   90
  90  360    0   90}

Test projection-1.3 {CylindricalEquidistant. Origin = -180.} {
    projection CylindricalEquidistant -180
    p $lats $lons
} { -90 -180 -180  -90
 -90  -90  -90  -90
 -90    0    0  -90
 -90   90   90  -90
 -90  180 -180  -90
 -90  270  -90  -90
 -90  360    0  -90
   0 -180 -180    0
   0  -90  -90    0
   0    0    0    0
   0   90   90    0
   0  180 -180    0
   0  270  -90    0
   0  360    0    0
  90 -180 -180   90
  90  -90  -90   90
  90    0    0   90
  90   90   90   90
  90  180 -180   90
  90  270  -90   90
  90  360    0   90}

Test projection-2.1 {NorthPolarEquidistant} {
    projection NorthPolarEquidistant
    p $lats $lons
} { -90 -180    0  180
 -90  -90 -180    0
 -90    0    0 -180
 -90   90  180    0
 -90  180    0  180
 -90  270 -180    0
 -90  360    0 -180
   0 -180    0   90
   0  -90  -90    0
   0    0    0  -90
   0   90   90    0
   0  180    0   90
   0  270  -90    0
   0  360    0  -90
  90 -180    0    0
  90  -90    0    0
  90    0    0    0
  90   90    0    0
  90  180    0    0
  90  270    0    0
  90  360    0    0}

Test projection-3.1 {SouthPolarEquidistant} {
    projection SouthPolarEquidistant
    p $lats $lons
} { -90 -180    0    0
 -90  -90    0    0
 -90    0    0    0
 -90   90    0    0
 -90  180    0    0
 -90  270    0    0
 -90  360    0    0
   0 -180    0  -90
   0  -90  -90    0
   0    0    0   90
   0   90   90    0
   0  180    0  -90
   0  270  -90    0
   0  360    0   90
  90 -180    0 -180
  90  -90 -180    0
  90    0    0  180
  90   90  180    0
  90  180    0 -180
  90  270 -180    0
  90  360    0  180}

set lats [[nap "ap(-80.0, 80.0, 40.0)"]]

Test projection-4.1 {Mercator. No origin.} {
    projection Mercator
    p $lats $lons
} { -80.0000 -180.0000 -180.0000 -139.5866
 -80.0000  -90.0000  -90.0000 -139.5866
 -80.0000    0.0000    0.0000 -139.5866
 -80.0000   90.0000   90.0000 -139.5866
 -80.0000  180.0000  180.0000 -139.5866
 -80.0000  270.0000  270.0000 -139.5866
 -80.0000  360.0000  360.0000 -139.5866
 -40.0000 -180.0000 -180.0000  -43.7115
 -40.0000  -90.0000  -90.0000  -43.7115
 -40.0000    0.0000    0.0000  -43.7115
 -40.0000   90.0000   90.0000  -43.7115
 -40.0000  180.0000  180.0000  -43.7115
 -40.0000  270.0000  270.0000  -43.7115
 -40.0000  360.0000  360.0000  -43.7115
   0.0000 -180.0000 -180.0000    0.0000
   0.0000  -90.0000  -90.0000    0.0000
   0.0000    0.0000    0.0000    0.0000
   0.0000   90.0000   90.0000    0.0000
   0.0000  180.0000  180.0000    0.0000
   0.0000  270.0000  270.0000    0.0000
   0.0000  360.0000  360.0000    0.0000
  40.0000 -180.0000 -180.0000   43.7115
  40.0000  -90.0000  -90.0000   43.7115
  40.0000    0.0000    0.0000   43.7115
  40.0000   90.0000   90.0000   43.7115
  40.0000  180.0000  180.0000   43.7115
  40.0000  270.0000  270.0000   43.7115
  40.0000  360.0000  360.0000   43.7115
  80.0000 -180.0000 -180.0000  139.5866
  80.0000  -90.0000  -90.0000  139.5866
  80.0000    0.0000    0.0000  139.5866
  80.0000   90.0000   90.0000  139.5866
  80.0000  180.0000  180.0000  139.5866
  80.0000  270.0000  270.0000  139.5866
  80.0000  360.0000  360.0000  139.5866}

Test projection-4.2 {Mercator. origin = 0.} {
    projection Mercator 0
    p $lats $lons
} { -80.0000 -180.0000  180.0000 -139.5866
 -80.0000  -90.0000  270.0000 -139.5866
 -80.0000    0.0000    0.0000 -139.5866
 -80.0000   90.0000   90.0000 -139.5866
 -80.0000  180.0000  180.0000 -139.5866
 -80.0000  270.0000  270.0000 -139.5866
 -80.0000  360.0000    0.0000 -139.5866
 -40.0000 -180.0000  180.0000  -43.7115
 -40.0000  -90.0000  270.0000  -43.7115
 -40.0000    0.0000    0.0000  -43.7115
 -40.0000   90.0000   90.0000  -43.7115
 -40.0000  180.0000  180.0000  -43.7115
 -40.0000  270.0000  270.0000  -43.7115
 -40.0000  360.0000    0.0000  -43.7115
   0.0000 -180.0000  180.0000    0.0000
   0.0000  -90.0000  270.0000    0.0000
   0.0000    0.0000    0.0000    0.0000
   0.0000   90.0000   90.0000    0.0000
   0.0000  180.0000  180.0000    0.0000
   0.0000  270.0000  270.0000    0.0000
   0.0000  360.0000    0.0000    0.0000
  40.0000 -180.0000  180.0000   43.7115
  40.0000  -90.0000  270.0000   43.7115
  40.0000    0.0000    0.0000   43.7115
  40.0000   90.0000   90.0000   43.7115
  40.0000  180.0000  180.0000   43.7115
  40.0000  270.0000  270.0000   43.7115
  40.0000  360.0000    0.0000   43.7115
  80.0000 -180.0000  180.0000  139.5866
  80.0000  -90.0000  270.0000  139.5866
  80.0000    0.0000    0.0000  139.5866
  80.0000   90.0000   90.0000  139.5866
  80.0000  180.0000  180.0000  139.5866
  80.0000  270.0000  270.0000  139.5866
  80.0000  360.0000    0.0000  139.5866}

set lats [[nap "{-90.0 -71.0 -55.0}"]]
set lons [[nap "ap(-180.0, 180.0, 90.0)"]]

Test projection-5.1 {SouthPolarStereographic} {
    projection SouthPolarStereographic
    p $lats $lons
} {  -90.0000  -180.0000     0.0000  4000.0000
  -90.0000   -90.0000     0.0000  4000.0000
  -90.0000     0.0000     0.0000  4000.0000
  -90.0000    90.0000     0.0000  4000.0000
  -90.0000   180.0000     0.0000  4000.0000
  -71.0000  -180.0000     0.0000  1917.2399
  -71.0000   -90.0000 -2082.7601  4000.0000
  -71.0000     0.0000     0.0000  6082.7601
  -71.0000    90.0000  2082.7601  4000.0000
  -71.0000   180.0000     0.0000  1917.2399
  -55.0000  -180.0000     0.0000    79.1006
  -55.0000   -90.0000 -3920.8994  4000.0000
  -55.0000     0.0000     0.0000  7920.8994
  -55.0000    90.0000  3920.8994  4000.0000
  -55.0000   180.0000     0.0000    79.1006}

Test projection-5.2 {SouthPolarStereographic} {p -70.8592 79.0113
} { -70.8592   79.0113 2059.9970 4400.0012}

Test projection-5.3 {SouthPolarStereographic} {p -58.9962 90.0000
} { -58.9962   90.0000 3449.9958 4000.0000}

Test projection-5.4 {SouthPolarStereographic} {p -64.2586 156.140
} { -64.2586  156.1400 1149.9942 1399.9916}


Test projection-6.1 {SouthPolarStereographic transpose} {
    projection_transpose SouthPolarStereographic
    p $lats $lons
} {  -90.0000  -180.0000  4000.0000     0.0000
  -90.0000   -90.0000  4000.0000     0.0000
  -90.0000     0.0000  4000.0000     0.0000
  -90.0000    90.0000  4000.0000     0.0000
  -90.0000   180.0000  4000.0000     0.0000
  -71.0000  -180.0000  1917.2399     0.0000
  -71.0000   -90.0000  4000.0000 -2082.7601
  -71.0000     0.0000  6082.7601     0.0000
  -71.0000    90.0000  4000.0000  2082.7601
  -71.0000   180.0000  1917.2399     0.0000
  -55.0000  -180.0000    79.1006     0.0000
  -55.0000   -90.0000  4000.0000 -3920.8994
  -55.0000     0.0000  7920.8994     0.0000
  -55.0000    90.0000  4000.0000  3920.8994
  -55.0000   180.0000    79.1006     0.0000}

Test projection-6.2 {SouthPolarStereographic transpose} {p -70.8592 79.0113
} { -70.8592   79.0113 4400.0012 2059.9970} 

Test projection-6.3 {SouthPolarStereographic transpose} {p -58.9962 90.0000
} { -58.9962   90.0000 4000.0000 3449.9958}

Test projection-6.4 {SouthPolarStereographic transpose} {p -64.2586 156.140
} { -64.2586  156.1400 1399.9916 1149.9942}

return
