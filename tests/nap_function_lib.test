# nap_function_lib.test --
# 
# Test functions defined in file $env(LIBRARY_DIR)/nap_function_lib.tcl
#
# Copyright (c) 2003, CSIRO Australia
# Author: Harvey Davies, CSIRO Atmospheric Research
# $Id: nap_function_lib.test,v 1.5 2003/10/28 23:11:44 dav480 Exp $

source $env(LIBRARY_DIR)/nap_function_lib.tcl

Test nap_function_lib-1.1 {simple regression} {
# Problem 11 on p226 of Schaum's "Theory & Problems of Statistics" by Murray R. Spiegel, 1961
    [nap "regression({1 3 4 6 8 9 11 14}, {1 2 4 4 5 7  8  9})"]
} {0.545455 0.636364}

Test nap_function_lib-1.2 {multiple regression} {
# Problem 3 on p273 of Schaum's "Theory & Problems of Statistics" by Murray R. Spiegel, 1961
    [nap "regression(
	transpose({57 59 49 62 51 50 55 48 52 42 61 57} /// {8 10 6 11 8 7 10 9 10 6 12 9}),
	{64 71 53 67 55 58 77 57 56 51 76 68})"]
} {3.65122 0.85461 1.50633}

Test nap_function_lib-2.1 {isMember} {
    [nap "isMember({{1 3}{  5 9}}, {1 2 3 9})"]
} {1 1
0 1}

Test nap_function_lib-3.1 {scaleAxis xstart == xend} {
    [nap "scaleAxis(3,3)"] value
} {3}

Test nap_function_lib-3.2 {scaleAxis xstart == xend} {
    [nap "scaleAxis(0,0)"] value
} {0}

Test nap_function_lib-3.3 {scaleAxis} {
    [nap "scaleAxis(3, 3.6, 2)"] value
} {3 3.5}

Test nap_function_lib-3.4 {scaleAxis} {
    [nap "scaleAxis(3, 3.6)"] value
} {3 3.1 3.2 3.3 3.4 3.5 3.6}

Test nap_function_lib-3.5 {scaleAxis} {
    [nap "scaleAxis(-3.1, 3.6)"] value
} {-3 -2 -1 0 1 2 3}

Test nap_function_lib-3.6 {scaleAxis} {
    [nap "scaleAxis(0, 3.1)"] value
} {0 0.5 1 1.5 2 2.5 3}

Test nap_function_lib-3.7 {scaleAxis} {
    [nap "scaleAxis(-3.1, 0)"] value
} {-3 -2.5 -2 -1.5 -1 -0.5 0}

Test nap_function_lib-4.1 {scaleAxisSpan xstart == xend} {
    [nap "scaleAxisSpan(3,3)"] value
} {0 0.5 1 1.5 2 2.5 3}

Test nap_function_lib-4.2 {scaleAxisSpan xstart == xend} {
    [nap "scaleAxisSpan(0,0)"] value
} {0 0.2 0.4 0.6 0.8 1}

Test nap_function_lib-4.3 {scaleAxisSpan} {
    [nap "scaleAxisSpan(3, 3.6, 2)"] value
} {3 4}

Test nap_function_lib-4.4 {scaleAxisSpan} {
    [nap "scaleAxisSpan(3, 3.6)"] value
} {3 3.1 3.2 3.3 3.4 3.5 3.6}

Test nap_function_lib-4.5 {scaleAxisSpan} {
    [nap "scaleAxisSpan(-3.1, 3.6)"] value
} {-4 -3 -2 -1 0 1 2 3 4}

Test nap_function_lib-4.6 {scaleAxisSpan} {
    [nap "scaleAxisSpan(0, 3.1)"] value
} {0 0.5 1 1.5 2 2.5 3 3.5}

Test nap_function_lib-4.7 {scaleAxisSpan} {
    [nap "scaleAxisSpan(-3.1, 0)"] value
} {-3.5 -3 -2.5 -2 -1.5 -1 -0.5 0}

# Following problems from Spiegel, M. R., "Theory and Problems of Statistics", Schaum, 1961.
Test nap_function_lib-5.1 {moving_average of vector (page 285)} {
    [nap "moving_average({2 6 1 5 3 7 2}, 3)"] value
} {3 4 3 5 4}

Test nap_function_lib-5.2 {moving_average of vector (page 290)} {
    nap "v = {50.0 36.5 43.0 44.5 38.9 38.1 32.6 38.7 41.7 41.1 33.8}"
    [nap "moving_average(v, 5)"] value -f %.1f
} {42.6 40.2 39.4 38.6 38.0 38.4 37.6}

Test nap_function_lib-5.3 {moving_average of vector (page 290)} {
    [nap "moving_average(v, 4)"] value -f %.1f
} {43.5 40.7 41.1 38.5 37.1 37.8 38.5 38.8}

Test nap_function_lib-5.4 {moving_average of vector} {
    [nap "moving_average(v, 1)"] value -f %.1f
} {50.0 36.5 43.0 44.5 38.9 38.1 32.6 38.7 41.7 41.1 33.8}

Test nap_function_lib-5.5 {moving_average of vector} {
    [nap "moving_average(v, 11)"] value -f %.1f
} {39.9}

Test nap_function_lib-5.6 {moving_average of vector} {
    [nap "moving_average(v, 2, 2)"] value -f %.2f
} {43.25 43.75 38.50 35.65 41.40}

Test nap_function_lib-5.7 {moving_average of matrix} {
    nap "m = reshape(v, {4 6})"
    [nap "moving_average(m, 1)"]
} {50.0 36.5 43.0 44.5 38.9 38.1
32.6 38.7 41.7 41.1 33.8 50.0
36.5 43.0 44.5 38.9 38.1 32.6
38.7 41.7 41.1 33.8 50.0 36.5}

Test nap_function_lib-5.8 {moving_average of matrix} {
    [nap "moving_average(m, {2 3})"]
} {40.4167 40.9167 40.5000 41.0667
39.5000 41.3167 39.6833 39.0833
40.9167 40.5000 41.0667 38.3167}

Test nap_function_lib-5.8 {moving_average of matrix} {
    [nap "moving_average(m, {2 3}, {2 3})"]
} {40.4167 41.0667
40.9167 38.3167}

Test nap_function_lib-5.9 {moving_average of matrix} {
    [nap "moving_average(m, 3, 3)"]
} {40.7222 39.5556}

