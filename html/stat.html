<!-- $Id: stat.html,v 1.5 2004/09/03 06:28:16 dav480 Exp $ -->
<html>

<head> <title>
NAP Library: stat.tcl
</title> </head>

<body>

<h2> <center>
Statistical Functions
</center> </h2>

<h3>Table of Contents</h3>

<ol>
    <li><a href="#Introduction">Introduction</a>
    <li><a href="#Simple_Statistics">Simple Statistics</a>
    <ul>
	<li><a href="#am">Arithmetic mean: <code>am</code></a>
	<li><a href="#gm">Geometric mean: <code>gm</code></a>
	<li><a href="#median">Median: <code>median</code></a>
	<li><a href="#mode">Mode: <code>mode</code></a>
	<li><a href="#rms">Root mean square: <code>rms</code></a>
	<li><a href="#sd">Standard-deviation (with division by n): <code>sd</code></a>
	<li><a href="#sd1">Standard-deviation (with division by n-1): <code>sd1</code></a>
	<li><a href="#var">Variance (with division by n): <code>var</code></a>
	<li><a href="#var1">Variance (with division by n-1): <code>var1</code></a>
    </ul>
    <li><a href="#moving_average">Moving average: <code>moving_average</code></a>
</ol>

<h3><a name=Introduction>Introduction</h3>

These are defined in <code>stat.tcl</code>.
Note that there are also built-in statistical functions called 
<a href="function.html#Correlation"><code>correlation</code></a>
and
<a href="function.html#Correlation"><code>moving_correlation</code></a>.

<h3><a name=Simple_Statistics>Simple Statistics</h3>

<p>
Three examples are provided for each function.
The first uses the vector <code>v</code> which is defined as follows (note the missing values):
<pre>
% nap "v = {12 6 _ 7 3 15 _ 10 18 6}"
</pre>

<p>
The second example produces statistics of each column of a matrix.
The third example produces statistics of each row of the same matrix.
This matrix is called <code>m</code> and is defined as follows:
<pre>
% nap "m = {
    {1.5 2.1 1.5 0.2}
    {6.2 4.9   _ 0.2}
}"
</pre>

<h4>
<a name=am>
Arithmetic mean:
<code>am(</code><var>x</var>[<code>,</code><var>verb_rank</var>]<code>)</code>
</h4>

<pre>
% [nap "am(v)"]
9.625
% [nap "am(m)"]
3.85 3.5 1.5 0.2
% [nap "am(m,1)"]
1.325 3.76667
</pre>

<h4>
<a name=gm>
Geometric mean:
<code>gm(</code><var>x</var>[<code>,</code><var>verb_rank</var>]<code>)</code>
</h4>

<pre>
% [nap "gm(v)"]
8.38752
% [nap "gm(m)"]
3.04959 3.2078 1.5 0.2
% [nap "gm(m,1)"]
0.985957 1.82476
</pre>

<h4>
<a name=median>
Median:
<code>median(</code><var>x</var>[<code>,</code><var>verb_rank</var>]<code>)</code>
</h4>

<pre>
% [nap "median(v)"]
8.5
% [nap "median(m)"]
3.85 3.5 1.5 0.2
% [nap "median(m,1)"]
1.5 4.9
</pre>

<h4>
<a name=mode>
Mode:
<code>mode(</code><var>x</var>[<code>,</code><var>verb_rank</var>]<code>)</code>
</h4>

<pre>
% [nap "mode(v)"]
6
% [nap "mode(m)"]
3.85 3.5 1.5 0.2
% [nap "mode(m,1)"]
1.50625 3.7625
</pre>

<h4>
<a name=rms>
Root mean square:
<code>rms(</code><var>x</var>[<code>,</code><var>verb_rank</var>]<code>)</code>
</h4>

<pre>
% [nap "rms(v)"]
10.7413
% [nap "rms(m)"]
4.51054 3.76962 1.5 0.2
% [nap "rms(m,1)"]
1.49583 4.56399
</pre>

<h4>
<a name=sd>
Standard-deviation (with division by n):
<code>sd(</code><var>x</var>[<code>,</code><var>verb_rank</var>]<code>)</code>
</h4>

<pre>
% [nap "sd(v)"]
4.76806
% [nap "sd(m)"]
2.35 1.4 0 0
% [nap "sd(m,1)"]
0.694172 2.57725
</pre>

<h4>
<a name=sd1>
Standard-deviation (with division by n-1):
<code>sd1(</code><var>x</var>[<code>,</code><var>verb_rank</var>]<code>)</code>
</h4>

<pre>
% [nap "sd1(v)"]
5.09727
% [nap "sd1(m)"]
3.3234 1.9799 _ 0
% [nap "sd1(m,1)"]
0.801561 3.15647
</pre>

<h4>
<a name=var>
Variance (with division by n):
<code>var(</code><var>x</var>[<code>,</code><var>verb_rank</var>]<code>)</code>
</h4>

<pre>
% [nap "var(v)"]
22.7344
% [nap "var(m)"]
5.5225 1.96 0 0
% [nap "var(m,1)"]
0.481875 6.64222
</pre>

<h4>
<a name=var1>
Variance (with division by n-1):
<code>var1(</code><var>x</var>[<code>,</code><var>verb_rank</var>]<code>)</code>
</h4>

<pre>
% [nap "var1(v)"]
25.9821
% [nap "var1(m)"]
11.045 3.92 _ 0
% [nap "var1(m,1)"]
0.6425 9.96333
</pre>

<h3>
<a name=moving_average>
Moving Average:
<code>moving_average(</code><var>x</var><code>,</code><var>shape_window</var>[,</code><var>step</var>]<code>)</code>
</h3>

Move window of specified shape by specified step (can vary for each dimension).
Result is arithmetic mean of <var>x</var> values in each window.
<var>x</var> can have any rank > 0.

<p>
<var>shape_window</var> is either a scalar or a vector with an element for each dimension.
If it is a scalar then it is treated as a vector with 
<code>rank(</code><var>x</var><code>)</code>
identical elements. 

<p>
Similarly, <var>step</var> is either a scalar or a vector with an element for each dimension.
If it is a scalar then it is treated as a vector with 
<code>rank(</code><var>x</var><code>)</code>
identical elements. 
The value -1 is treated like 1, except that missing values are prepended & appended
(along this dimension of <var>x</var>) to produce a result with the same dimension size
as <var>x</var>.

<p>
The following examples illustrate the application of 
<code>moving_average</code>
to a vector.

<pre>
% nap "v = {12 6 _ 7 3 15 _ 10 18 5}"
% [nap "moving_average(v, 3)"] value
9 6.5 5 8.33333 9 12.5 14 11
% [nap "moving_average(v, 3, 3)"] value
9 8.33333 14
% [nap "moving_average(v, 3, -1)"] value
9 9 6.5 5 8.33333 9 12.5 14 11 11.5
</pre>

<p>
The following examples illustrate the application of 
<code>moving_average</code>
to a matrix.

<pre>
% nap "m = {
    {1 2 1 4 0 0}
    {5 4 2 9 2 7}
    {0 1 1 3 1 4}
}"
% [nap "moving_average(m, {3 3})"] value
1.88889 3.00000 2.55556 3.33333
% [nap "moving_average(m, {3 3}, {3 3})"] value
1.88889 3.33333
% [nap "moving_average(m, 3, 3)"] value
1.88889 3.33333
% [nap "moving_average(m, 3, -1)"] value
3.00000 2.50000 3.66667 3.00000 3.66667 2.25000
2.16667 1.88889 3.00000 2.55556 3.33333 2.33333
2.50000 2.16667 3.33333 3.00000 4.33333 3.50000
% [nap "moving_average(m, {1 3})"] value
1.333333 2.333333 1.666667 1.333333
3.666667 5.000000 4.333333 6.000000
0.666667 1.666667 1.666667 2.666667
</pre>

<P>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2" bgcolor="737b9c">
  <TR>
    <TD align="center"><FONT color="#ffffff" size=-2><SPAN class="titlebar">
        <b>Author:</b> <a href="http://sourceforge.net/users/dav480/">Harvey Davies</a>
        &nbsp; &nbsp; &nbsp;
        &copy; 2002, CSIRO Australia.
        &nbsp; &nbsp; &nbsp;
        <a href="http://www.csiro.au/legalnotices/disclaimer.html">Legal Notice and Disclaimer</a>
        <br>

        <b>CVS Version Details:</b> $Id: stat.html,v 1.5 2004/09/03 06:28:16 dav480 Exp $
        </SPAN></FONT>
    </TD>
  </TR>
</TABLE>

</body>
</html>
