<!-- $Id: data_type.html,v 1.5 2005/02/02 00:41:43 dav480 Exp $ -->
<html>

<head> <title>
Data Types
</title> </head>

<body>

<h2> <center>
Data Types
</center> </h2>

<h3>Table of Contents</h3>

<ol>
    <li><a href="#data-types">NAP Data-types</a>
    <li><a href="#constant">Data-type of Constants</a>
    <li><a href="#functions">Data-type Conversion Functions</a>
    <li><a href="#result">Data-type of result of operation</a>
</ol>

<h3>
<a name=data-types>NAP Data-types
</h3>

A NAO can have any of the following data-types:

<p>
<table border>
            <tr>
                <th align=center>Name
                <th align=center>Description
            <tr>
                <td> <code>c8</code>
                <td> 8-bit character
            <tr>
                <td> <code>i8</code>
                <td> 8-bit signed integer
            <tr>
                <td> <code>i16</code>
                <td> 16-bit signed integer
            <tr>
                <td> <code>i32</code>
                <td> 32-bit signed integer
            <tr>
                <td> <code>u8</code>
                <td> 8-bit unsigned integer
            <tr>
                <td> <code>u16</code>
                <td> 16-bit unsigned integer
            <tr>
                <td> <code>u32</code>
                <td> 32-bit unsigned integer
            <tr>
                <td> <code>f32</code>
                <td> 32-bit floating-point
            <tr>
                <td> <code>f64</code>
                <td> 64-bit floating-point
            <tr>
                <td> <code>ragged</code>
                <td> compressed
            <tr>
                <td> <code>boxed</code>
                <td> slot numbers
        </table>

<p>
The
<code>ragged</code>
type provides an efficient way of storing arrays with many missing values around the edges.

<p>
A
<code>boxed</code>
NAO contains slot numbers pointing to other NAOs.
This allows one to construct arrays (normally vectors) of arrays.
Boxed vectors are generated by the
<a href="op.html#Link">
Link Operators &quot;<code>...</code>&quot; and &quot;<code>,</code>&quot;</a>.
Boxed vectors are used
<ul>
    <li> to pass multiple arguments to a function
    <li> to return multiple results from a function
    <li> in <em>cross-product indexing</em>
    <li> to generate <em>arithmetic progressions</em> with step sizes other than 1 and -1
</ul>
Boxed vectors can be unpacked using function
<code>open_box(</code><var>x</var><code>)</code>,
which is described in
<a href="function.html#Special_Data_types">Functions related to Special Data-types</a>.

<h3>
<a name=constant>Data-type of Constants
</h3>

<p>
A scalar constant can contain a data-type suffix, as in:
<PRE>
% [nap "3.7f32"] all
::NAP::53-53  f32  MissingValue: NaN  References: 0
Value:
3.7
% [nap "123u8"] all
::NAP::55-55  u8  MissingValue: (NULL)  References: 0
Value:
123
</PRE>

The following examples show that if there is no such suffix then floating-point
values are treated as <code>f64</code>
while integer values are treated as <code>i32</code>:
<PRE>
% [nap "3.7"] all
::NAP::57-57  f64  MissingValue: NaN  References: 0
Value:
3.7
% [nap "123"] all
::NAP::58-58  i32  MissingValue: -2147483648  References: 0
Value:
123
</PRE>

<h3>
<a name=functions>Data-type Conversion Functions
</h3>

There is a function with the name of each data-type except 
<code>ragged</code>
and
<code>boxed</code>.
Each such function converts its argument to that data-type.
For example:
<PRE>
% [nap "f64(123)"] all
::NAP::62-62  f64  MissingValue: NaN  References: 0
Value:
123
% [nap "c8(123)"] all; # ascii character 123
::NAP::66-66  c8  MissingValue: (NULL)  References: 0
Value:
{
% [nap "f32({123 -1.2 0})"] all; # vector with 3 elements
::NAP::70-70  f32  MissingValue: NaN  References: 0
Dimension 0   Size: 3      Name: (NULL)    Coordinate-variable: (NULL)
Value:
123 -1.2 0
</PRE>

<p>
The parentheses <code>()</code> in these three examples are not needed.
Deleting them:
<PRE>
% [nap "f64 123"] all
::NAP::26-26  f64  MissingValue: NaN  References: 0
Value:
123
% [nap "c8 123"] all
::NAP::29-29  c8  MissingValue: (NULL)  References: 0
Value:
{
% [nap "f32{123 -1.2 0}"] all
::NAP::33-33  f32  MissingValue: NaN  References: 0
Dimension 0   Size: 3      Name: (NULL)    Coordinate-variable: (NULL)
Value:
123 -1.2 0
</PRE>

<h3>
<a name=result>Data-type of result of operation
</h3>

<p>
Many operations 
(defined by an operator or a function) 
produce a result whose data-type matches that of their operands/arguments 
(if these all have the same data-type).
The following examples illustrate this for the <em>subtract</em> operator:

<PRE>
% [nap "3 - 1"] all
::NAP::57-57  i32  MissingValue: -2147483648  References: 0  Unit: (NULL)
Value:
2
% [nap "3f32 - 1f32"] all
::NAP::61-61  f32  MissingValue: NaN  References: 0  Unit: (NULL)
Value:
2
% [nap "3u8 - 1u8"] all
::NAP::65-65  u8  MissingValue: 255  References: 0  Unit: (NULL)
Value:
2
</PRE>

<p>
What happens if the operands differ in data-type?
Let's try adding <code>f32</code> and <code>f64</code> values:

<PRE>
% [nap "234f32 + 3.5f64"] all
::NAP::40-40  f64  MissingValue: NaN  References: 0
Value:
237.5
</PRE>
The result is of type <code>f64</code>, so there is no loss of precision.
Next let's try adding <code>i32</code> and <code>f32</code> values:

<PRE>
% [nap "234 + 3.5f32"] all
::NAP::54-54  f64  MissingValue: NaN  References: 0  Unit: (NULL)
Value:
237.5
</PRE>

<P>
Why is the result <code>f64</code> rather than <code>f32</code>?
This prevents possible loss of precision, as in:

<PRE>
% [nap "f32(123456789) + 5f32"] all -format %d
::NAP::48-48  f32  MissingValue: NaN  References: 0  Unit: (NULL)
Value:
123456800
</PRE>

This is due to the fact that an
<code>i32</code> value has 31 bits (9.3 digits) of precision, whereas
an <code>f32</code> value has only 24 bits (7.2 digits) of precision.
So both operands must be converted to <code>f64</code> before the addition takes place.
This is shown by:

<PRE>
% [nap "123456789 + 5f32"] all -format %d
::NAP::43-43  f64  MissingValue: NaN  References: 0  Unit: (NULL)
Value:
123456794
</PRE>

<P>
Some operations produce a result whose data-type is independent of the types of 
the operands.
In particular, relational and logical
operators always produce an <code>i8</code> result with value 1 for true and 0 for false.
The following illustrates the "<code>&gt;</code>" operator:

<PRE>
% [nap "9 > 8"] all
::NAP::43-43  i8  MissingValue: (NULL)  References: 0
Value:
1
</PRE>

<P>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2" bgcolor="737b9c">
  <TR>
    <TD align="center"><FONT color="#ffffff" size=-2><SPAN class="titlebar">
        <b>Author:</b> <a href="http://sourceforge.net/users/dav480/">Harvey Davies</a>
        &nbsp; &nbsp; &nbsp;
        &copy; 2002, CSIRO Australia.
        &nbsp; &nbsp; &nbsp;
        <a href="http://www.csiro.au/legalnotices/disclaimer.html">Legal Notice and Disclaimer</a>
        <br>

        <b>CVS Version Details:</b> $Id: data_type.html,v 1.5 2005/02/02 00:41:43 dav480 Exp $
        </SPAN></FONT>
    </TD>
  </TR>
</TABLE>

</body>
</html>

