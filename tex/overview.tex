    % Overview of NAP

\section{Overview of Nap (N-Dimensional Array Processor)}
\label{overview}

  \par Nap is a loadable extension of 
  \href{http://wiki.tcl.tk/}{Tcl}. Nap provides a powerful and
  efficient facility for processing data in the form of n-dimensional
  arrays. It has been designed to provide a tcl-flavoured
  array-processing facility with much of the functionality of languages
  such as 
  \href{http://www.acm.org/sigapl/}{APL}, 
  \href{http://www.fortran.com/fortran/}{Fortran-90}, 
  \href{http://www.rsinc.com/idl/index.asp}{IDL}, 
  \href{http://www.jsoftware.com/}{J}, 
  \href{http://www.mathworks.com/}{matlab} and 
  \href{http://www.octave.org/}{octave}. Three other tcl
  extensions which provide array-processing facilities are 
  \href{http://www-obs.univ-lyon1.fr/\%7Ethiebaut/TiM/TiM.html}{TiM},
  \href{http://sourceforge.net/projects/blt/}{BLT} and 
  \href{http://www.gm.com/automotive/innovations/rnd/TK3/TK3D-Software-Description.html}{ Tk3D}.
  \par Existing Tcl facilities (e.g. Tcl variables and procedures) are
  used where appropriate. The new facilities have been designed to
  match similar existing ones. In particular, Nap expressions use
  conventions which are essentially a superset of those of the Tcl 
  \texttt{expr} command. Support is provided for data based on 
  \emph{n-dimensional grids}, where the dimensions correspond to
  continuous spatial coordinates. There are interfaces to the 
  \href{http://www.hdfgroup.org/}{HDF} and 
  \href{http://www.unidata.ucar.edu/packages/netcdf/index.html}{netCDF}
  file formats commonly used for such data, especially in Earth
  sciences such as Oceanography and Meteorology. There is a new photo
  image format for Nap data.
  \par Nap was developed as part of the CSIRO 
\href{http://www.eoc.csiro.au/cats/caps/}{Caps}
  project, but can be loaded and used without the (satellite oriented)
  Caps extension. However the Caps extension requires Nap since most
  Caps data are stored as NAOs.
  \par Data are stored in memory as 
  \emph{n-dimensional array objects (NAOs)}, which include
  information such as:
\begin{bullets}
    \item data-type
    \item unique ID (handle generated by Nap) called the 
    \emph{OOC-name} (OOCs are discussed below)
    \item optional label
    \item optional C format
    \item optional unit of measure
    \item reference count (allowing automatic deletion of the NAO when it
    is no longer needed)
    \item optional missing-value (used to indicate undefined data,
    etc.)
    \item rank (number of dimensions)
    \item dimension sizes
    \item optional dimension names
    \item optional pointers to 
    \emph{coordinate-variable} NAOs associated with each
    dimension
\end{bullets}

There are eleven data-types, six for integers, two for
  floating-point, one for characters, one 
  \emph{pointer} type (allowing arrays of arrays) and a 
  \emph{ragged} type providing a form of compression.

NAOs are created by the Tcl commands \texttt{nap} and \texttt{nap\_get}.

The \texttt{nap} command takes arguments specifying an expression in a manner similar to the 
  \texttt{expr} command.
However, unlike 
  \texttt{expr}, 
  \texttt{nap} provides:
\begin{bullets}
\item assignment (to a Tcl variable whose value is set to the OOC-name of the resultant NAO)
\item substitution of Tcl names (obviating the need for `\texttt{\$}' prefixes)
\item array facilities (constants, operators, functions, indexing)
\end{bullets}

Array indices can take fractional values, which give results defined by
  n-dimensional linear interpolation.
Index values can be specified
  indirectly via coordinate-variable values (e.g. latitudes and
  longitudes).

The \texttt{nap\_get} command creates a NAO from data read from a
  binary, HDF or netCDF file. Some platforms (only Linux on Intel 386
  at the time of writing) support reading of remote virtual netCDF
  files provided by 
  \href{http://www.opendap.org/}{OPeNDAP} (a.k.a. 
  \emph{DODS}) web servers.

Every NAO has an associated Tcl command called an 
  \emph{object-oriented command} (\emph{OOC}). This is used to:
\begin{bullets}
    \item display the data in the NAO
    \item display other information about the NAO such as its data-type
    and dimensions
    \item change data and other details
    \item write data from the NAO to a binary, HDF or netCDF file
\end{bullets}

As usual in Tcl, OOC and 
  \texttt{nap\_get} command options can be abbreviated provided
  there is no ambiguity.
  \par Nap provides many operators and built-in functions. One can define
  new functions by defining Tcl procedures with the 
  \texttt{proc} command. It is also possible to call functions
  written in C and Fortran.
  \par The 
  \emph{Caps/Nap GUI} provides browsers for:
\begin{bullets}
    \item Tcl variables
    \item image files (e.g. GIF, JPEG)
    \item AVHRR satellite files (Caps package required)
    \item ATSR satellite files (Caps package required)
    \item CIF files (Melbourne University format)
    \item HDF/netCDF files
\end{bullets}
The HDF/netCDF browser is a convenient tool for quickly browsing
  HDF and netCDF files. 
\\
Selected data can be
\begin{bullets}
    \item displayed as text
    \item graphed
    \item shown as various kinds of images and maps
    \item animated
    \item used to create a NAO for further processing using NAP
\end{bullets}
